# Telegram Bot –¥–ª—è –≤–∏–∫—Ç–æ—Ä–∏–Ω –ø–æ Dota 2

Telegram-–±–æ—Ç –Ω–∞ Laravel, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–æ–¥–∏—Ç –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã –ø–æ –∏–≥—Ä–µ Dota 2 –≤ –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–∞—Ö –∏ —Å—É–ø–µ—Ä–≥—Ä—É–ø–ø–∞—Ö.

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

- üéÆ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã –ø–æ Dota 2
- ‚è± 10 —Å–µ–∫—É–Ω–¥ –Ω–∞ –æ—Ç–≤–µ—Ç
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤
- üîÑ –ó–∞–ø—É—Å–∫ –≤–∏–∫—Ç–æ—Ä–∏–Ω 10 —Ä–∞–∑ –≤ —á–∞—Å (–∫–∞–∂–¥—ã–µ 6 –º–∏–Ω—É—Ç)
- üë• –†–∞–±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø–∞—Ö –∏ —Å—É–ø–µ—Ä–≥—Ä—É–ø–ø–∞—Ö
- üìà –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–∞–º—ã—Ö –±—ã—Å—Ç—Ä—ã—Ö –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- PHP >= 8.1
- Composer
- MySQL / PostgreSQL / SQLite
- Telegram Bot Token (–ø–æ–ª—É—á–∏—Ç—å —É [@BotFather](https://t.me/BotFather))

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–ª–∏ —Ä–∞—Å–ø–∞–∫—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
composer install
```

3. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:
```bash
cp .env.example .env
```

4. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–ª—é—á –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
```bash
php artisan key:generate
```

5. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤ `.env`:
```env
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=dota2_quiz_bot
DB_USERNAME=root
DB_PASSWORD=your_password
```

6. –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ –≤ `.env`:
```env
TELEGRAM_BOT_TOKEN=your_bot_token_here
TELEGRAM_WEBHOOK_URL=https://yourdomain.com/webhook/telegram
```

7. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
```bash
php artisan migrate
```

8. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–∞–º–∏:
```bash
php artisan db:seed --class=Dota2QuestionsSeeder
```

9. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–æ—Ç–µ:
```bash
php artisan telegram:bot-info
```

10. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–µ–±—Ö—É–∫ Telegram:
```bash
php artisan telegram:set-webhook
```
–ò–ª–∏ —É–∫–∞–∂–∏—Ç–µ URL —è–≤–Ω–æ:
```bash
php artisan telegram:set-webhook https://yourdomain.com/webhook/telegram
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –≤–∏–∫—Ç–æ—Ä–∏–Ω –∫–∞–∂–¥—ã–µ 6 –º–∏–Ω—É—Ç –¥–æ–±–∞–≤—å—Ç–µ –≤ crontab:

```bash
* * * * * cd /path-to-your-project && php artisan schedule:run >> /dev/null 2>&1
```

–ò–ª–∏ –Ω–∞ Windows –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Task Scheduler –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è `php artisan schedule:run` –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É –∏–ª–∏ —Å—É–ø–µ—Ä–≥—Ä—É–ø–ø—É Telegram
2. –î–∞–π—Ç–µ –±–æ—Ç—É –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É, —á—Ç–æ–±—ã –±–æ—Ç —É–∑–Ω–∞–ª –æ —á–∞—Ç–µ
4. –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–Ω–µ—Ç –ø—Ä–æ–≤–æ–¥–∏—Ç—å –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã –∫–∞–∂–¥—ã–µ 6 –º–∏–Ω—É—Ç

### –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- –í–∏–∫—Ç–æ—Ä–∏–Ω—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–µ 6 –º–∏–Ω—É—Ç
- –£—á–∞—Å—Ç–Ω–∏–∫–∏ –º–æ–≥—É—Ç –æ—Ç–≤–µ—á–∞—Ç—å, –Ω–∞–ø–∏—Å–∞–≤ –Ω–æ–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (1, 2, 3...) –∏–ª–∏ —Å–∞–º –æ—Ç–≤–µ—Ç
- –ß–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥ –±–æ—Ç –ø–æ–∫–∞–∂–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã

–í—ã –º–æ–∂–µ—Ç–µ –≤—Ä—É—á–Ω—É—é –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤–∏–∫—Ç–æ—Ä–∏–Ω—É –≤–æ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —á–∞—Ç–∞—Ö:
```bash
php artisan quiz:start-random
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
app/
‚îú‚îÄ‚îÄ Console/
‚îÇ   ‚îú‚îÄ‚îÄ Commands/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ StartRandomQuiz.php    # –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤–∏–∫—Ç–æ—Ä–∏–Ω
‚îÇ   ‚îî‚îÄ‚îÄ Kernel.php                  # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á
‚îú‚îÄ‚îÄ Http/
‚îÇ   ‚îú‚îÄ‚îÄ Controllers/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ TelegramWebhookController.php  # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–µ–±—Ö—É–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ Middleware/                # Middleware
‚îú‚îÄ‚îÄ Jobs/
‚îÇ   ‚îî‚îÄ‚îÄ CheckQuizResults.php       # Job –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
‚îú‚îÄ‚îÄ Models/
‚îÇ   ‚îú‚îÄ‚îÄ Question.php               # –ú–æ–¥–µ–ª—å –≤–æ–ø—Ä–æ—Å–∞
‚îÇ   ‚îú‚îÄ‚îÄ ActiveQuiz.php             # –ú–æ–¥–µ–ª—å –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã
‚îÇ   ‚îî‚îÄ‚îÄ QuizResult.php             # –ú–æ–¥–µ–ª—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
‚îî‚îÄ‚îÄ Services/
    ‚îú‚îÄ‚îÄ TelegramService.php        # –°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Telegram API
    ‚îî‚îÄ‚îÄ QuizService.php            # –°–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∏–∫—Ç–æ—Ä–∏–Ω–∞–º–∏

database/
‚îú‚îÄ‚îÄ migrations/                    # –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ seeders/
    ‚îú‚îÄ‚îÄ DatabaseSeeder.php
    ‚îî‚îÄ‚îÄ Dota2QuestionsSeeder.php   # Seeder —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏ –ø–æ Dota 2
```

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã:
- `questions` - –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è –≤–∏–∫—Ç–æ—Ä–∏–Ω
- `active_quizzes` - –∞–∫—Ç–∏–≤–Ω—ã–µ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã
- `quiz_results` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `jobs` - –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á
- `failed_jobs` - –Ω–µ—É–¥–∞—á–Ω—ã–µ –∑–∞–¥–∞—á–∏

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤

–í—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã –≤—Ä—É—á–Ω—É—é –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π seeder:

```bash
php artisan make:seeder MoreDota2QuestionsSeeder
```

–ó–∞—Ç–µ–º –¥–æ–±–∞–≤—å—Ç–µ –≤–æ–ø—Ä–æ—Å—ã –≤ –º–µ—Ç–æ–¥ `run()` –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
php artisan db:seed --class=MoreDota2QuestionsSeeder
```

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–õ–æ–≥–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `storage/logs/laravel.log`. –í—ã –º–æ–∂–µ—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ `.env`:

```env
LOG_LEVEL=debug
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤–µ–±—Ö—É–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
```bash
curl https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getWebhookInfo
```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `storage/logs/laravel.log`

3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:
```bash
php artisan schedule:list
```

### –í–∏–∫—Ç–æ—Ä–∏–Ω—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ cron/task scheduler –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–º–∞–Ω–¥–∞ `quiz:start-random` —Ä–∞–±–æ—Ç–∞–µ—Ç:
```bash
php artisan quiz:start-random
```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω —Ö–æ—Ç—è –±—ã –≤ –æ–¥–Ω—É –≥—Ä—É–ø–ø—É –∏ –ø–æ–ª—É—á–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
